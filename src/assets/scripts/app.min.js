var windowHeight = $(window).height();
var viewportWidth = $(window).width();

function noscroll() {
  window.scrollTo( 0, 0 );
}

function bodyFreezeScroll() {
  window.addEventListener('scroll', noscroll);
  $('body').css({'overflow': 'hidden', 'max-height': windowHeight});
  $('body').addClass('scroll-disabled');
}

function bodyUnfreezeScroll() {
  window.removeEventListener('scroll', noscroll);
  $('body').css({'overflow': 'auto', 'max-height': 'inherit'});
  $('body').removeClass('scroll-disabled');
}

function isheaderActive(){
  if( $('.btn-dropdown-menu').hasClass('show') || $('.main-nav > li').hasClass('active') ){
    $('.jazeera_overlay, header').addClass('active');
    bodyFreezeScroll();
  } else {
    $('.jazeera_overlay, header').removeClass('active');
    bodyUnfreezeScroll();
  }
}

function issearchActive(){
  if( $('.search-box-wrap').hasClass('active')){
    bodyFreezeScroll();
  } else {
    bodyUnfreezeScroll();
  }
}

function isModifySearchActive(){
  if( $('.modify-search-wrap').hasClass('active')){
    bodyFreezeScroll();
  } else {
    bodyUnfreezeScroll();
  }
}


$.fn.pVal = function(){
  var $this = $(this),
    val = $this.eq(0).val();
  if(val == $this.attr('placeholder'))
    return '';
  else
    return val;
}
;
bodyFreezeScroll();
$(window).load(function(){
  //bodyUnfreezeScroll();
  $('.preloader').addClass('disable');
  $(".dropdown-menu").each(function(){
    var elem = $(this).find('.dropdown-option:first-child').find("input").val(0);
    //elem.trigger('change');
  });
});;

$(document).ready(function() {

  $('body').append('<div class="jazeera_overlay" />');
$('body').append('<div class="jazeera_backdrop" />');

$('.form-wrap').each(function(){
	$(this).find('.form-field').last().addClass('last-field');
});

$('a[data-goto-href]').click(function(e){
	var scrollto = $(this).attr('href');
	$('body').scrollTo(scrollto, 600);
	e.preventDefault();
});

//FloatLabel
$( '.float-label-wrapper' ).FloatLabel();

//Match Height
$('.package-list-item .packages-body').matchHeight();

//Placeholder for IE
$('.form-control').placeholder();

// Custom Select
var minimumResultsForSearch = -1;
$('.custom-select').select2({
	minimumResultsForSearch: -1,
  'allowClear': false,
placeholder: function(){
  $(this).data('placeholder');
}
}).on('select2:open', function (e) {
	$('.dropdown-toggle + .dropdown-menu').removeClass('show');
});

// phoneCodeSelect
var phoneCodeSelect = $(".intl-tel-input").intlTelInput({
//autoFormat: false,
//autoHideDialCode: false,
//defaultCountry: "jp",
nationalMode: false,
//onlyCountries: ['us', 'ch', 'ca', 'do'],
//preferredCountries: ['cn', 'jp'],
//responsiveDropdown: true
//preventInvalidNumbers: true,
preventInvalidDialCodes: true
});

$('body.scroll-disabled').bind('touchmove', function(e){
  e.preventDefault();
});
;
  var departure_calender = $('#calendar-departure');
var return_calender = $('#calendar-return');

/*Departure Selector*/
departure_calender.fullCalendar({
  
  header: {
    left: '',
    center: '',
    right: ''
  },
  prev: '.left-single-arrow',
  next: '.right-single-arrow',

  height: 94,
  contentHeight: 'auto',

  fixedWeekCount: false,
  weekMode: 'liquid',
  
  //defaultDate: '2018-11-12',
  defaultView: 'month',
  navLinks: true, // can click day/week names to navigate views
  editable: true,
  
  selectable: true,
  selectHelper: false,
  selectAllow: function(selectInfo) {
    return moment().diff(selectInfo.start) <= 0
  },
  
  navLinks: false,
  themeSystem: 'standard',
  inline: true,
  
  select: function(dateText, inst) {

    var selectedDate = new Date(dateText);
    var selectedNextDate = moment(selectedDate, "YYYY-MM-DD").add(1, 'days');
    return_calender.fullCalendar('gotoDate', selectedNextDate);

    $('.flexible-dates-picker.return .fc-month-view table td').each(function(e){
      if($(this).data('date') > moment(selectedDate).format('YYYY-MM-DD')){
        $(this).removeClass('inactive');
      } else{
        $(this).addClass('inactive');
      }
    });


  },
  
  dayRender: function(date, cell) {

    var moment = departure_calender.fullCalendar('getDate');
    var currentMonth = moment.format('MMM');

    if(date.format('DD') == 1 || date.format('DD') == 12){
      cell.html('<div class="date-cell-wrap"><div class="hightlight bg-info">Recommended</div>' + '<div class="date">'+date.format('MMM DD')+'</div>' + '<div class="price">INR <strong>8,329.00</strong> </div> </div>');
    } else {
      cell.html('<div class="date-cell-wrap"><div class="date">'+date.format('MMM DD')+'</div>' + '<div class="price">INR <strong>8,329.00</strong> </div> </div>');
    }
    
  },

  dayClick: function (date, allDay, jsEvent, view) {
    $(this).parents('.flexible-dates-picker').find(".fc-cell-selected").removeClass("fc-cell-selected");
    $(this).addClass('fc-cell-selected');
  },

  viewRender: function (view, element) {

    var intervalStart = view.intervalStart;
    var currentMonth = intervalStart.format('YYYY-MM-DD');

    var lastMonthStart = moment(currentMonth).subtract(1, 'months').format('DD MMM');
    var lastMonthEnd = moment(currentMonth).subtract(1, 'months').endOf('month').format('DD MMM');

    var nextMonthStart = moment(currentMonth).add(1, 'months').format('DD MMM');
    var nextMonthEnd = moment(currentMonth).add(1, 'months').endOf('month').format('DD MMM');

    departure_calender.parents('.date-picker-wrap').find('.calender-switcher .calender-switch-btn.left .dates-btwn').empty().append('<strong>'+ lastMonthStart + '</strong> to <strong>' + lastMonthEnd + '</strong>');
    departure_calender.parents('.date-picker-wrap').find('.calender-switcher .calender-switch-btn.right .dates-btwn').empty().append('<strong>'+ nextMonthStart + '</strong> to <strong>' + nextMonthEnd + '</strong>');

  }

});

$('#calendar-departure-prev').click(function(e) {
  departure_calender.fullCalendar('prev');
  e.preventDefault();
});

$('#calendar-departure-next').click(function(e) {
  departure_calender.fullCalendar('next');
  e.preventDefault();
});




/*Returing Selector*/
return_calender.fullCalendar({
  
  header: {
    left: '',
    center: '',
    right: ''
  },
  prev: '.left-single-arrow',
  next: '.right-single-arrow',

  height: 94,
  contentHeight: 'auto',

  fixedWeekCount: false,
  weekMode: 'liquid',
  
  //defaultDate: '2018-12-12',
  defaultView: 'month',
  navLinks: true, // can click day/week names to navigate views
  editable: true,
  
  selectable: true,
  selectHelper: false,
  selectAllow: function(selectInfo) {
    return moment().diff(selectInfo.start) <= 0
  },
  
  navLinks: false,
  themeSystem: 'standard',
  inline: true,
  
  select: function(dateText, inst) {
    var selectedDate = new Date(dateText);
    // console.log(selectedDate);
  },
  
  dayRender: function(date, cell) {

    var moment = return_calender.fullCalendar('getDate');
    var currentMonth = moment.format('MMM');

    if(date.format('DD') == 1 || date.format('DD') == 12){
      cell.html('<div class="date-cell-wrap"><div class="hightlight bg-info">Recommended</div>' + '<div class="date">'+date.format('MMM DD')+'</div>' + '<div class="price">INR <strong>8,329.00</strong> </div> </div>');
    } else {
      cell.html('<div class="date-cell-wrap"><div class="date">'+date.format('MMM DD')+'</div>' + '<div class="price">INR <strong>8,329.00</strong> </div> </div>');
    }
    
  },

  dayClick: function (date, allDay, jsEvent, view) {
    $(this).parents('.flexible-dates-picker').find(".fc-cell-selected").removeClass("fc-cell-selected");
    $(this).addClass('fc-cell-selected');
  },

  viewRender: function (view, element) {

    var intervalStart = view.intervalStart;
    var currentMonth = intervalStart.format('YYYY-MM-DD');

    var lastMonthStart = moment(currentMonth).subtract(1, 'months').format('DD MMM');
    var lastMonthEnd = moment(currentMonth).subtract(1, 'months').endOf('month').format('DD MMM');

    var nextMonthStart = moment(currentMonth).add(1, 'months').format('DD MMM');
    var nextMonthEnd = moment(currentMonth).add(1, 'months').endOf('month').format('DD MMM');

    return_calender.parents('.date-picker-wrap').find('.calender-switcher .calender-switch-btn.left .dates-btwn').empty().append('<strong>'+ lastMonthStart + '</strong> to <strong>' + lastMonthEnd + '</strong>');
    return_calender.parents('.date-picker-wrap').find('.calender-switcher .calender-switch-btn.right .dates-btwn').empty().append('<strong>'+ nextMonthStart + '</strong> to <strong>' + nextMonthEnd + '</strong>');

  }

});

$('#calendar-return-prev').click(function(e) {
  return_calender.fullCalendar('prev');
  e.preventDefault();
});

$('#calendar-return-next').click(function(e) {
  return_calender.fullCalendar('next');
  e.preventDefault();
});

$('.flexible-dates-picker.return .fc-month-view table td').on('click', function(e) {
  e.preventDefault();
});;
  // Validate Form
function validateForm(id) {
    var valid = $(id).validate().checkForm();
    if (valid) {
        $(id).find('.form-btn-wrap').removeClass('hidden');
        $(id).find('.btn-wrap .btn').removeAttr('disabled');
    } else {
        $(id).find('.form-btn-wrap').addClass('hidden');
        $(id).find('.btn-wrap .btn').attr("disabled", "true");
    }
}

$.validator.addMethod('checkValidFormat', function(value, element){
    var stringPattern = new RegExp("(0[123456789]|10|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31)([/])(0[123456789]|10|11|12)([/])([1-2][0-9][0-9][0-9])");
    if(stringPattern.test(value)){ return true; }
    else { return false; }
},"Please enter valid date.");

$.validator.addMethod("namefield", function(value, element) { 
    return this.optional(element) || /^[a-z\'\s]+$/i.test(value);
}, "Invalid Characters");

$.validator.addMethod("phonefield", function(value, element) {
    return this.optional(element) || /^[0-9\+\s]+$/i.test(value);
}, "Invalid phone number");

$.validator.addMethod("msgfield", function(value, element) {
    return this.optional(element) || /^[a-z\0-9\,.'"!()+@\s]+$/i.test(value); 
}, "Invalid Characters");

$.validator.addMethod("monthYear", function (value, element) {
  return this.optional(element) || /^\d{2}\/\d{2}$/.test(value);
}, "Please enter MM/YY format only.");

$.validator.addMethod("noSpace", function(value, element) { 
  return value.indexOf(" ") < 0 && value != ""; 
}, "The format doesn't seem right");

$.validator.addMethod("monthLimit", function (value, element) {
    var myRegexp = /^(\d{2})(.*?)$/;
    var match = myRegexp.exec(value);
    var bValid;
    bValid = false;
    if (match[1] > 0 && match[1] < 13) {
        bValid = true;
    }
    return this.optional(element) || bValid;
}, "Please enter month between 1 and 12");

$.validator.addMethod("yearLimit", function (value, element) {
    var myRegexp = /^(.*?)(\d{2})$/;
    var match = myRegexp.exec(value);
    var bValid;
    bValid = false;
    if (match[2] >= moment().format('YY')) {
        bValid = true;
    }
    return this.optional(element) || bValid;
}, "Please enter valid Year.");

$.validator.addMethod("emailValidate", function (value, element) {
    var myRegexp = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
    var bValid;
    if(value.indexOf('@')!=-1){
        bValid = false;
        var match = myRegexp.test(value);
        if(match){
            bValid = true;
        }
    } else {
        bValid = true;
    }
    return this.optional(element) || bValid;
}, "Please enter valid email address.");

var defaultOptions = {
    errorElement: "span",
    errorClass: "help-block",
    focusInvalid: true,
    //onkeyup: true,
    onblur: true,
    highlight: function (element, errorClass, validClass) {
        var elm = $(element);
        var group = elm.closest('.form-field');

        if(group.length) {
            group.addClass('has-error');
            group.removeClass('populated');
        }
    },
    unhighlight: function (element, errorClass, validClass) {
        var elm = $(element);
        var group = elm.closest('.form-field');
        
        if(group.length) {
            group.removeClass('has-error');
            group.addClass('populated');
        }
    },
    errorPlacement: function (error, element) {

        //console.log('errorPlacement... this never gets called :(', error, element);

        var elm = $(element);

        if (elm.parent('.form-field').length) {
            //error.insertAfter(elm);
            elm.parent('.form-field').prepend(error);
        }

        /*
        if (elm.parent('.input-group').length || elm.parent('.input-group-custom').length) {
            error.insertAfter(elm.parent());
        }
        else if (elm.prop('type') === 'checkbox' || elm.prop('type') === 'radio') {
            error.appendTo(elm.closest(':not(input, label, .checkbox, .radio)').first());
        } else {
            error.insertAfter(elm);
        }
        */

    },
    submitHandler: function (form) {
        console.log('Valid form submited.');
        form.submit();
    }
};

$.validator.setDefaults(defaultOptions);

var manageBookingForm = $("#manageBookingForm");
manageBookingForm.validate({
  rules: {
    pnr_manage_boking: {
      required: true,
      minlength: 2,
      maxlength: 25,
      //namefield: true
    },
    email_manage_booking: {
      required: true,
      maxlength: 35,
      emailValidate: true
    }
  },
  messages: {
    pnr_manage_boking: {
      required: "Please enter PNR Number"
    },
    email_manage_booking: {
      required: "Please enter Email / Last Name"
    }
  }
});

manageBookingForm.on('blur keyup change', 'input', function(event) {
  validateForm('#manageBookingForm');
});;
var searchcheckInForm = $("#searchcheckInForm");
searchcheckInForm.validate({
  rules: {
    pnr_checkin: {
      required: true,
      minlength: 2,
      maxlength: 25,
      //namefield: true
    },
    email_checkin: {
      required: true,
      maxlength: 35,
      emailValidate: true
    }
  },
  messages: {
    pnr_manage_boking: {
      required: "Please enter PNR Number"
    },
    email_manage_booking: {
      required: "Please enter Email / Last Name"
    }
  }
});

searchcheckInForm.on('blur keyup change', 'input', function(event) {
  validateForm('#searchcheckInForm');
});;
var searchHotelsForm = $("#searchHotelsForm");
searchHotelsForm.validate({
  rules: {
    landmark_hotel: {
      required: true,
      minlength: 2,
      maxlength: 25
    },
    checkin_hotel_search: {
      required: true
    },
    checkout_hotel_search: {
      required: true,
    }
  },
  messages: {
    landmark_hotel: {
      required: "Please enter country, city, district or landmark"
    },
    checkin_hotel_search: {
      required: "Please select Check-in date"
    },
    checkout_hotel_search: {
      required: "Please select Check-out date"
    }
  }
});

searchHotelsForm.on('blur keyup change', 'input', function(event) {
  validateForm('#searchHotelsForm');
});;
var passengerInfoForm = $("#passengerInfoForm");
passengerInfoForm.validate({
  rules: {
    passengerCollapseAdult1Title: {
      required: true
    },
    passengerCollapseAdult1FirstName: {
      required: true
    },
    passengerCollapseAdult1LastName: {
      required: true,
      noSpace: true
    },
    passengerCollapseAdult1Nationality: {
      required: true
    },
    passengerCollapseAdult1FrequentflyerAirline: {
      required: true
    },
    passengerCollapseAdult1Frequentflyer: {
      required: true
    },

    passengerCollapseAdult2Title: {
      required: true
    },
    passengerCollapseAdult2FirstName: {
      required: true
    },
    passengerCollapseAdult2LastName: {
      required: true,
      noSpace: true
    },
    passengerCollapseAdult2Nationality: {
      required: true
    },
    passengerCollapseAdult2FrequentflyerAirline: {
      required: true
    },
    passengerCollapseAdult2Frequentflyer: {
      required: true
    },

    passengerCollapseChild1TravelingWith: {
      required: true
    },
    passengerCollapseChild1Title: {
      required: true
    },
    passengerCollapseChild1FirstName: {
      required: true
    },
    passengerCollapseChild1LastName: {
      required: true,
      noSpace: true
    },
    passengerCollapseChild1Nationality: {
      required: true
    },
    passengerCollapseChild1FrequentDOB: {
      required: true,
      checkValidFormat: true
    },
    passengerCollapseChild1FrequentflyerAirline: {
      required: true
    },
    passengerCollapseInfant1Frequentflyer: {
      required: true
    },

    passengerCollapseInfant1TravelingWith: {
      required: true
    },
    passengerCollapseInfant1Title: {
      required: true
    },
    passengerCollapseInfant1FirstName: {
      required: true
    },
    passengerCollapseInfant1LastName: {
      required: true,
      noSpace: true
    },
    passengerCollapseInfant1Nationality: {
      required: true
    },
    passengerCollapseInfant1FrequentDOB: {
      required: true,
      checkValidFormat: true
    },
    passengerCollapseInfant1FrequentflyerAirline: {
      required: true
    },
    passengerCollapseInfant1Frequentflyer: {
      required: true
    },

    contactDetailsPhoneCode: {
      required: true
    },
    contactDetailsPhoneNumber: {
      required: true,
      phonefield: true
    },
    contactDetailsFirstName: {
      required: true
    },
    contactDetailsEmailAddress: {
      required: true,
      email: true
    },
    contactDetailsNationality: {
      required: true
    },
    contactDetailsAutoCheckinsName: {
      namefield: true
    },
    contactDetailsAutoCheckinsPassportNumber: {
      // number: false
    },
    contactDetailsAutoCheckinsVisaNumber: {
      number: true
    },
    contactDetailsAutoCheckinsDateofExpiry: {
      checkValidFormat: true
    },
    contactDetailsAutoCheckinsDateofIssue: {
      checkValidFormat: true
    },
    contactDetailsAutoCheckinsVisaIssueDate: {
      checkValidFormat: true
    },
    contactDetailsAutoCheckinsVisaExpiryDate: {
      checkValidFormat: true
    }

  },
  messages: {
    contactDetailsAutoCheckinsName: {
      namefield: "Enter Name as indicated on your passport"
    },
    contactDetailsPhoneNumber: {
      phonefield: "Enter Valid Mobile Number"
    }
  }
});

$('#contactDetailsAutoCheckinsDateofExpiry').mask("00/00/0000");
$('#contactDetailsAutoCheckinsDateofIssue').mask("00/00/0000");
$('#contactDetailsAutoCheckinsVisaIssueDate').mask("00/00/0000");
$('#contactDetailsAutoCheckinsVisaExpiryDate').mask("00/00/0000");

passengerInfoForm.on('blur keyup change', 'input', function(event) {
  validateForm('#passengerInfoForm');
});;
//CreditCardForm Validation
var CreditCardForm = $("#CreditCardForm");
CreditCardForm.validate({
  rules: {
    creditCardStreetAddress: {
      required: true,
      minlength: 2,
      maxlength: 250
    },
    creditCardTownCity: {
      required: true,
      maxlength: 35
    },	
    creditCardCountry: {
    	required: true
    },	
    creditCardZip: {
    	required: true
    },	
    creditCardNumber: {
    	required: true,
    	//number: true,
    },	
    creditCardHolderName: {
    	required: true,
      namefield: true
    },
    creditCardHolderCountry: {
    	required: true
    },
    creditCardHolderRelationship: {
    	required: true
    },
    creditCardExpiration: {
    	required: true,
    	monthYear: true,
      monthLimit: true,
      yearLimit: true,
    },
    creditCardCVV: {
    	required: true,
    	number: true,
    	minlength: 2,
    	maxlength: 4
    }
  },
  messages: {
    creditCardStreetAddress: {
      required: "Please enter Street Address"
    },
    creditCardTownCity: {
      required: "Please enter Town or City"
    },
    creditCardCountry: {
      required: "Please enter Country / Region"
    },
    creditCardZip: {
      required: "Please enter Zip / Postal"
    },
    creditCardNumber: {
      required: "Please enter Card Number"
    },
    creditCardHolderName: {
      required: "Please enter Card Holder Name",
      namefield: "Enter Name as indicated on your Card"
    },
    creditCardHolderCountry: {
      required: "Please enter Card Holder Country"
    },
    creditCardHolderRelationship: {
      required: "Enter Card holder relationship to Traveler"
    },
    creditCardExpiration: {
      required: "Please enter Expiration Date"
    },
    creditCardCVV: {
      required: "Please enter CVV"
    }
  }
});

CreditCardForm.on('blur keyup change', 'input', function(event) {
  validateForm('#CreditCardForm');
});

//Field Formats
$('#creditCardNumber').mask("0000 0000 0000 0000");
$('#creditCardExpiration').mask("00/00");
$('#creditCardCVV').mask("0000");

//VoucherForm Valifation
var VoucherForm = $("#VoucherForm");
VoucherForm.validate({
  rules: {
    Vouchernumber: {
      required: true,
      minlength: 2,
      maxlength: 250,
      number: true,
    }
  },
  messages: {
    Vouchernumber: {
      required: "Please enter Voucher number"
    }
  }
});

VoucherForm.on('blur keyup change', 'input', function(event) {
  validateForm('#VoucherForm');
});;
var searchReturnFlight = $("#searchReturnFlight");
searchReturnFlight.validate({
  rules: {
    from_flight_search: {
      required: true
    },
    to_flight_search: {
      required: true
    },
    departure_flight_search: {
      required: true
    },
    return_flight_search: {
      required: true
    },
    passengers_flight_search: {
      required: true
    }
  },
  messages: {
    from_flight_search: {
      required: "Please select from location"
    },
    to_flight_search: {
      required: "Please select destination flight"
    },
    departure_flight_search: {
      required: "Please select departure date"
    },
    return_flight_search: {
      required: "Please select return date"
    },
    passengers_flight_search: {
      required: "Please select passengers details"
    }
  }
});

/*
searchReturnFlight.find('.spinner-input button').click(function(){
  $('#passengers_flight_search').trigger('blur');
  validateForm('#searchReturnFlight');
});
*/

searchReturnFlight.on('blur keyup change', 'input', function(event) {
  validateForm('#searchReturnFlight');
});;;
  //Banner Slideshow
var $bannerSlider = $('.slideshow-wrapper .slideshow').on('init', function(slick) {
  $('.slideshow-wrapper').addClass('loaded');
}).slick({
  lazyLoad: 'ondemand',
  autoplay: false,
  autoplaySpeed: 5000,
  dots: true,
  arrows: false,
  centerMode: false,
  infinite: false,
  speed: 800,
  fade: true,
  pauseOnHover: false,
  pauseOnFocus: false,
  appendDots: ".slideshow-controls .container",
  prevArrow: $('.banner-prev'),
  nextArrow: $('.banner-next')
});;
//Carousel Slideshow
if (viewportWidth > 768) {  

  var $carouselSlider = $('.carousel-wrap .carousel').on('init', function(slick) {
    $('.carousel-wrap').addClass('loaded');
  }).slick({
    lazyLoad: 'ondemand',
    autoplay: false,
    autoplaySpeed: 5000,
    dots: false,
    arrows: true,
    infinite: false,
    speed: 800,
    fade: false,
    pauseOnHover: false,
    pauseOnFocus: false,
    slidesToShow: 3,
    slidesToScroll: 1,
    centerMode: false,
    centerPadding: '15px',
    prevArrow: $('.carousel-prev'),
    nextArrow: $('.carousel-next'),
    responsive: [
      {
        breakpoint: 768,
        settings: {
          slidesToShow: 2,
          slidesToScroll: 1
        }
      }
    ]
  });  

};;
  // $('.scroll-panel').scrollbar();

$(".scroll-panel").mCustomScrollbar({
  axis:"y",
  theme:"minimal",
  autoHideScrollbar: false
});;
  var insuranceSelectionStatus = false;
$('#InsuranceSelectionForm input:checkbox').change(function(){

	if( $("#InsuranceSelectionForm input:checkbox:checked").length > 0){
		insuranceSelectionStatus = true;
	} else {
		insuranceSelectionStatus  = false;
	}

	if( $(this).parent().find('input').is(':checked') ){
		$(this).parents('.select-insurance-item').find('.select-insurance-popup input:checkbox').prop("checked", true);
		$(this).parents('.select-insurance-item').find('.select-insurance-inline input:checkbox').prop("checked", true);
		insuranceSelectionStatus = true;
	} else {
		$(this).parents('.select-insurance-item').find('.select-insurance-popup input:checkbox').prop("checked", false);
		$(this).parents('.select-insurance-item').find('.select-insurance-inline input:checkbox').prop("checked", false);
		insuranceSelectionStatus  = false;
	}

	if(insuranceSelectionStatus == true){
		$('.insurance-selection + .btn-wrap').find('.btn').prop("disabled", false);
		$('.popup-content .checkbox-wrap + .btn-wrap').find('.btn').prop("disabled", false);
	} else {
		$('.insurance-selection + .btn-wrap').find('.btn').prop("disabled", true);
		$('.popup-content .checkbox-wrap + .btn-wrap').find('.btn').prop("disabled", true);
	}

});

if(viewportWidth < 737){
	$('.select-insurance-wrap .select-insurance-item .select-insurance-popup .popup-inner .scroll-panel').css('height', windowHeight);
}

function isInsurancePopupActive(){
  if( $('.select-insurance-popup').hasClass('show')){
    bodyFreezeScroll();
    $('.jazeera_overlay').addClass('active');
  } else {
    bodyUnfreezeScroll();
    $('.jazeera_overlay').removeClass('active');
  }
}

isInsurancePopupActive();

$('.select-insurance-wrap .show-popup-btn').click(function(e){
	$(this).parents('.select-insurance-item').find('.select-insurance-popup').addClass('show');
	isInsurancePopupActive();
	e.preventDefault();
});

$('.select-insurance-popup .popup-inner .close-btn').click(function(e){
	$(this).parents('.select-insurance-item').find('.select-insurance-popup').removeClass('show');
	isInsurancePopupActive();
	e.preventDefault();
});


$(document).mouseup(function(e) {
  
  var insurance = $(".select-insurance-popup");
  if (!insurance.is(e.target) && insurance.has(e.target).length === 0) 
  {
  	insurance.removeClass('show');
  	isInsurancePopupActive();
  } else{
  	insurance.addClass('show');
  	isInsurancePopupActive();
  }
  
});;
  $('.add-ons-status-holder .summary-dropdown-wrap').click(function(e){
	$(this).parents('.add-ons-status-info-panel').siblings().removeClass('show');
	$(this).parents('.add-ons-status-info-panel').toggleClass('show');
	e.preventDefault();
});

function sysnTabs(selectedTab){
	$('.payment-methods-tabs .panel-switch input:radio').prop('checked', false);
	$('.payment-methods-tabs .panel-switch input:radio#'+selectedTab).prop('checked', true);
} 

function sysnMobileTabs(selectedTab){
	$('.payment-wrap .mobile-panel-switch input:radio').prop('checked', false);
	$('.payment-wrap .mobile-panel-switch input:radio#'+selectedTab+"Mobile").prop('checked', true);
} 

function activateTab(){
	var selectedTab = $('.payment-methods-tabs .panel-switch input:radio:checked').attr('id');
	$('section.payment-wrap form').removeClass('show');
	$('section.payment-wrap form[id="'+selectedTab+'Form"]').addClass('show');
	sysnMobileTabs(selectedTab);
}

function activateMobileTab(){
	var selectedTab = $('.payment-wrap .mobile-panel-switch input:radio:checked').attr('id');
	$('section.payment-wrap form').removeClass('show');
	$('section.payment-wrap form[id="'+selectedTab.split('Mobile')[0]+'Form"]').addClass('show');
	sysnTabs(selectedTab.split('Mobile')[0]);
}

$('.payment-methods-tabs .panel-switch input:radio').change(function(e){
	activateTab();
	e.preventDefault();
});

$('.payment-wrap .mobile-panel-switch input:radio').change(function(e){
	activateMobileTab();
	e.preventDefault();
});

activateTab();;
  function enableWindows() {
	$('#printArea').addClass('active');
	$('.add-ons-status-info-panel').addClass('show');
}

function disableWindows(dsfsdf) {
	$('#printArea').removeClass('active');
	$('.add-ons-status-info-panel').removeClass('show');
}

function ExportPdf(){ 

	kendo.pdf.defineFont({
        "jazeera_regular" : "assets/fonts/j9_Regular.ttf",
        "jazeera_black" : "assets/fonts/j9_Black.ttf",
        "jazeera_bold" : "assets/fonts/j9_Bold.ttf",
        "jazeera_light" : "assets/fonts/j9_Light.ttf",
        "jazeera_medium" : "assets/fonts/j9_Medium.ttf",
    });
	
	kendo.drawing.drawDOM("#printArea", { 
		//forcePageBreak: ".result-info",
		paperSize: "A4",
		margin: { left: "0.5cm", right: "0.5cm", top: "0.5cm", bottom: "0.5cm" },
		scale: 0.7,
		height: 500,
		landscape: true,
	})
	.then(function(group){
		kendo.drawing.pdf.saveAs(group, "Jazeera Airways - Booking Details.pdf");
		disableWindows();
	});
	
}

$('#saveBookingDetails').click(()=>{
	enableWindows();
	ExportPdf();
});


$('#printBookingDetails').click(()=>{
	$('#printArea').printThis({
	    importCSS: true,
	    loadCSS: "",
	    header: "",
	    beforePrint: enableWindows(),
    	afterPrint: disableWindows()  
	});
});

$('.confirm-booking-flight-info .summary-dropdown-wrap').click(function(e){
	//$(this).parents('.add-ons-status-info-panel').siblings().removeClass('show');
	$(this).parents('.add-ons-status-info-panel').toggleClass('show');
	e.preventDefault();
});;
  $('.passenger-details.details-form-wrap .card').each(function(){

	var title = $(this).find('[data-dynamic-title]').val();
	var firstname = $(this).find('[data-dynamic-firstname]').val();
	var lastname = $(this).find('[data-dynamic-lastname]').val();

	var passerger_name = '';
	if(firstname !='' || lastname != ''){
		var passerger_name = title + ' ' + firstname + ' ' +  lastname;
		$(this).find('.grp-label').empty().append(passerger_name);
	} else {
		$(this).find('.grp-label').empty().append('Enter Passenger Details:');
	}

});

function primaryContact() {
	var primaryContactName = $('.passenger-details .card-header-wrap .radio-wrap input:checked').parents('.card-header-wrap').find('.card-header .grp-label').text();
	if(primaryContactName){
		$('.contact-details .panel-label .title h3 strong').text(primaryContactName);
	}
}

function appendChanges(selectedElem) {
	var title = selectedElem.parents('.accordion-item').find('[data-dynamic-title]').val();
	var firstname = selectedElem.parents('.accordion-item').find('[data-dynamic-firstname]').val();
	var lastname = selectedElem.parents('.accordion-item').find('[data-dynamic-lastname]').val();

	var passerger_name = '';
	if(firstname !='' || lastname != ''){
		var passerger_name = title + ' ' + firstname + ' ' +  lastname;
		selectedElem.parents('.accordion-item').find('.grp-label').empty().append(passerger_name);
	} else {
		selectedElem.parents('.accordion-item').find('.grp-label').empty().append('Enter Passenger Details:');
	}

	primaryContact();

}


$('[data-dynamic-title], [data-dynamic-firstname], [data-dynamic-lastname]').keyup(function(e){
	var selectedElem = $(this);
	appendChanges(selectedElem)
});

$('[data-dynamic-title], [data-dynamic-firstname], [data-dynamic-lastname]').change(function(e){
	var selectedElem = $(this);
	appendChanges(selectedElem);
});


$('.change-primary-contact').click(function(e){
	$('body, html').scrollTo( '.passenger-details-wrap', 500);
	e.preventDefault();
});


$('.check-group input:checkbox').change(function(e){
	if( $(this). prop("checked") == true ){
		$(this).parents('.check-group').find('.form-grp').removeClass('hidden');
	} else {
		$(this).parents('.check-group').find('.form-grp').addClass('hidden');
	}
});

$('.card-header-wrap .radio-wrap input:radio').change(function(e){
	primaryContact();	
});

primaryContact();;
  //Mobile Header
$('.header-inner > .brand').clone().prependTo('.mobile-header');
//$('.search-box-wrap .search-panel .search-header').clone().appendTo('.mobile-header .mobile-menu-wrap');
$('.header-inner > .main-nav').clone().appendTo('.mobile-header .mobile-menu-wrap');
//$('.header-inner > .main-nav').clone().appendTo('.mobile-header .mobile-menu-wrap');

$('header .mobile-header .mobile-menu-wrap ul.main-nav > li > a').click(function(e) {
	//$('header .mobile-header .mobile-menu-wrap ul.main-nav li .sub-menu').removeClass('active');
	$(this).parent('li').siblings().find('.sub-menu').removeClass('active');
	$(this).next('.sub-menu').toggleClass('active');
	e.preventDefault();
});

$("header .header-inner .main-nav > li a").click(function(){
	if($(this).next('.sub-menu').length){
	  $(this).parent().toggleClass('active');
	  isheaderActive();
	} else {
	  $(this).parent('li').siblings().removeClass('active');
	  $('.jazeera_overlay, header').removeClass('active');
	  bodyUnfreezeScroll();
	}
});

$('.mobile-menu-toggle, .close-mobile-header').click(function(){
	$('.mobile-menu-toggle').toggleClass('active');
	$('.mobile-menu-wrap').toggleClass('active');
	$('.mobile-login-toggle').removeClass('active');
});

$('.mobile-login-toggle').click(function(e){

	$('.mobile-menu-wrap').removeClass('active');
	$(this).toggleClass('active');

	if($(this).hasClass('active')){
		$('.dropdown-login-register').prev('.btn').addClass('active');
		$('.dropdown-login-register').addClass('show');
		$('.jazeera_overlay, header').addClass('active');
		bodyFreezeScroll();
	} else {
		$('.dropdown-login-register').prev('.btn').removeClass('active');
		$('.dropdown-login-register').removeClass('show');
		$('.jazeera_overlay, header').removeClass('active');
		bodyUnfreezeScroll();
	}

	e.preventDefault();
});


$('.login-switcher-btns .radio-wrap').click(function(){
	$('.login-form-wrap div').removeClass('active');
	var selectedform = $(this).find('input').attr('id');
	$('.login-form-wrap div[data-form="'+selectedform+'"]').addClass('active');
});;
  //Tab Switch
$('a[data-switch]').click(function(e){
	var selectedTab = $(this).attr('href');
	$(this).parent().find('[data-switch]').removeClass('active');
	$(this).addClass('active');
	$(this).parent().siblings('[data-panel]').removeClass('active');
	$(this).parent().siblings('[data-panel][id$='+selectedTab.split('#')[1]+']').addClass('active');
	

	$('.tt-menu .tt-dataset').find('.tt-suggestion').show();
	//$('.tab-panel input, .tab-panel .tt-input').val('').trigger('click');
	$('.tab-panel .form-field').removeClass('populated');
	$('.tab-panel input').removeAttr('data-selected');
	
	e.preventDefault();
});

$('a[data-switch]').click(function(e){
	var selectedTab = $(this).attr('href');
	//var selectedTab = $('[data-switch].active').attr('href');
	function addBackDrop() {
		if(selectedTab!=''){
			if( $('[data-panel][id$='+selectedTab.split('#')[1]+']').hasClass('active') ){
				$('.jazeera_backdrop').addClass('active');
			} else {
				$('.jazeera_backdrop').removeClass('active');
			}
		} else {
			// $('.jazeera_backdrop').removeClass('active');
		}
	}

	if(selectedTab == '#manage-booking' || selectedTab == '#check-in' || selectedTab == '#hotels' || selectedTab == '#one-way' || selectedTab == '#multi-city'){
		addBackDrop();
	}
});

$('.jazeera_backdrop').click(function(){
	$(this).removeClass('active');
});

//Collapsing panel
$('.collapsing-panel .panel-head h6').prepend('<i class="icomoon icon-toggle"></i> ');
	$('.collapsing-panel .panel-head').click(function(e) {
	$('.panel-details').slideUp();
	$(this).next('.panel-details').slideDown();
	e.preventDefault();
});

//Mobile Collapse Panel
$('a[data-collapse]').click(function(e){
	$(this).siblings('[data-collapse]').removeClass('active');
	$(this).toggleClass('active');
	$(this).next('.panel-data-wrapper[data-panel]').siblings('[data-panel]').removeClass('active');
	$(this).next('.panel-data-wrapper[data-panel]').toggleClass('active');
	e.preventDefault();
});

//Collapse Expand*/
$('.panel-collapse').on('show.bs.collapse', function () {
	$(this).siblings('.panel-heading').addClass('active');
});

$('.panel-collapse').on('hide.bs.collapse', function () {
	$(this).siblings('.panel-heading').removeClass('active');
});
//Collapse Expand*/

$('.accordion-wrapper .accordion-item .card-header h5.grp-label').each(function(e){
	var titleToClone = $(this).text();
	$(this).parents('.accordion-item').find('.card-body .panel-label .title p').prepend('<span class="cloned">'+titleToClone+'</span>');
});;

  function checkValid(){

  var isValid = false;
  $('#multi-city .form-row.active:last').find('input.single-date-picker, input.tt-input').each(function() {
    if ($.trim($(this).val()) != '') {
      isValid = true;
    } else {
      isValid = false;
    }
  });

  // console.log(isValid);

  if(isValid == true){

    //$('#multi-city .form-row.row + .hidden-field-group .form-row:first').addClass('active');
    //$('.form-row.row + .hidden-field-group .form-row:not(.active):first').addClass('active');
    $('#addFlight').removeClass('disabled');

  } else {
    //$('#multi-city .hidden-field-group .form-row:not(.active)').removeClass('active');
    //$('.form-row.row + .hidden-field-group .form-row:not(.active):first').removeClass('active');
    $('#addFlight').addClass('disabled');
  }

  return isValid;

  $('#addFlight').trigger('click');

}

$('#addFlight').click(function(e){
  $('#multi-city .form-row:not(.active):first').addClass('active');
  $(this).addClass('disabled');
  e.preventDefault();
});

var isRowfilled = false;
function checkFlightLocationInputStatus() {

  $('.location-select').trigger('change');
  
  if( $('#from_flight_search').val()!='' && $('#to_flight_search').val()!='' ){
    isRowfilled = true;
  } else {
    isRowfilled = false;
  }
  
  if(isRowfilled == true){
    $('#from_flight_search').parents('.form-row').next('.form-row').removeClass('hidden');
    $('.switchLocations').addClass('active');
    $('.jazeera_backdrop').addClass('active');
  } else {
    $('#from_flight_search').parents('.form-row').next('.form-row').addClass('hidden');
    $('.switchLocations').removeClass('active');
    $('.jazeera_backdrop').removeClass('active');
  }

  checkValid();

}

/*
$(document).on("click", "*, .date-picker-wrapper", function(){
  checkFlightLocationInputStatus();
});

$('.range-picker').on('click', '*', function(){
  checkFlightLocationInputStatus();
});
*/

var Airports = new Bloodhound({
  queryTokenizer: Bloodhound.tokenizers.whitespace,
  datumTokenizer: Bloodhound.tokenizers.obj.whitespace('name','country', 'code'),
  identify: function(obj) { return obj.code; },
  prefetch: 'assets/json/airports.json'
});


function suggestionsWithDefaultsCurrentLocation(q, sync, async) {
  if (q === '') {

      sync(Airports.get('DXB', 'SHJ'));
      
      /*
      var defaultList = [];
      $.getJSON( "assets/json/airports.json", function( data ) {
        $.each(data, function( index, value ) {
          var attr = $('#from_flight_search').attr('data-selected');
          if (typeof attr !== typeof undefined && attr !== false && attr != data[index].code){
            defaultList.push(data[index]);
            console.log(data[index]);
          } else {
            defaultList.push(data[0]);
          }
        });
      });
      */

  }
}

function suggestionsWithDefaultsAirports(q, sync, async) {
  if (q === '') {
    Airports.search('a', sync); 
  } else {
    Airports.search(q, sync); 
  }
}

$('.location-select').typeahead({
  minLength: 0,
  highlight: true,
  autoSelect: true,
  showHintOnFocus: true,
  showDefault: true,
  //displayKey: 'name','country', 'code',
  //async: true,
  classNames: {
    open: 'is-open',
    empty: 'is-empty',
    cursor: 'is-active',
    suggestion: 'Typeahead-suggestion',
    selectable: 'Typeahead-selectable'
  }
},
{
  name: 'current-location',
  display: function(item){ return item.name+' ('+item.code+'), '+item.country},
  source: suggestionsWithDefaultsCurrentLocation,
  limit: 2,
  templates: {
    header: '<h5 class="league-name">Current location</h5>',
    empty: [''],
    pending: [''],
    suggestion: Handlebars.compile('<div class="tt-suggestion" data-code="{{code}}"> <div class="flag-wrap"> <i class="flag-icon flag-icon-{{flag}}"></i></div>   <div class="suggetion-title"> <div class="country-title">{{name}}</div> <div class="country-sub-title">{{country}}</div></div> <span class="flight-code">{{code}}</span> </div>')
  }
},
{
  name: 'airports-list',
  display: function(item){ return item.name+' ('+item.code+'), '+item.country},
  source: suggestionsWithDefaultsAirports,
  limit: 10,
  templates: {
    header: '<h5 class="league-name">All locations</h5>',
    //pending: ['<div class="empty-message">Loading...</div>'],
    empty: [''],
    //empty: ['<div class="empty-message">No results</div>'],
    suggestion: Handlebars.compile('<div class="tt-suggestion" data-code="{{code}}"> <div class="flag-wrap"> <i class="flag-icon flag-icon-{{flag}}"></i></div>   <div class="suggetion-title"> <div class="country-title">{{name}}</div> <div class="country-sub-title">{{country}}</div></div> <span class="flight-code">{{code}}</span> </div>')
  }
}).on('typeahead:selected', function (obj, datum) {

  var nextTabIndex = obj.currentTarget.tabIndex + 1;

  $('#'+obj.target.id).attr('data-selected', datum.code);
  
  if( $(this).parents('.form-wrap').find('input[tabindex="'+nextTabIndex+'"]').val() == '' ){
    $(this).parents('.form-wrap').find('input[tabindex="'+nextTabIndex+'"]').focus().parents('.locations').addClass('show-popup');
  }

  if($(this).parents('.sub-panel-data').find('input[tabindex="'+nextTabIndex+'"]').hasClass('datepicker')){
    $('input[tabindex="'+nextTabIndex+'"]').parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    $('input[tabindex="'+nextTabIndex+'"]').parents('.daterangepicker-group').addClass('show-popup');
  }

  checkFlightLocationInputStatus();
  $(this).parents('.locations').removeClass('show-popup');

  if($(this).parents('.form-wrap').find('input[tabindex="'+nextTabIndex+'"]').hasClass('single-date-picker')){

    /*
    if( $(this).parents().hasClass('hidden-field-group') ){
      $(this).parents('.form-wrap').find('input[tabindex="'+nextTabIndex+'"]').focus().trigger('click');
      console.log('only hidden');
    }
    */

    $(this).parents('.form-wrap').find('input[tabindex="'+nextTabIndex+'"]').parents('.daterangepicker-single').find('.range-picker-wrap').addClass('active');
    $(this).parents('.form-wrap').find('input[tabindex="'+nextTabIndex+'"]').parents('.daterangepicker-single').addClass('show-popup');

  }

}).on('click', function(){
  
  $('.dropdown-toggle + .dropdown-menu').removeClass('show');
  $('.range-picker-wrap').removeClass('active');
  $(this).parents('.locations').addClass('show-popup');

}).on('typeahead:render', function () {
  
  $('.tt-menu .tt-dataset').find('.tt-suggestion').show();

  if( $('.tt-menu.is-open .tt-dataset').find('.tt-suggestion').length == 1 ){
    $('.tt-menu, .twitter-typeahead pre').addClass('hide');
  } else {
    $('.tt-menu, .twitter-typeahead pre').removeClass('hide');
  }

  var from_flight_search_attr = $('#from_flight_search').attr('data-selected');
  if (typeof from_flight_search_attr !== typeof undefined && from_flight_search_attr !== false) {
    $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+from_flight_search_attr+'"]').hide();
  }

  var to_flight_search_attr = $('#to_flight_search').attr('data-selected');
  if (typeof to_flight_search_attr !== typeof undefined && to_flight_search_attr !== false) {
    $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+to_flight_search_attr+'"]').hide();
  }

  var from_flight_search_oneway_attr = $('#from_flight_search_oneway').attr('data-selected');
  if (typeof from_flight_search_oneway_attr !== typeof undefined && from_flight_search_oneway_attr !== false) {
    $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+from_flight_search_oneway_attr+'"]').hide();
  }

  var to_flight_search_oneway_attr = $('#to_flight_search_oneway').attr('data-selected');
  if (typeof to_flight_search_oneway_attr !== typeof undefined && to_flight_search_oneway_attr !== false) {
    $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+to_flight_search_oneway_attr+'"]').hide();
  }

  
  /* var from_flight_search_muticity1 = $('#from_flight_search_muticity1').attr('data-selected');
  if (typeof from_flight_search_muticity1 !== typeof undefined && from_flight_search_muticity1 !== false) {
    $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+from_flight_search_muticity1+'"]').hide();
  }

  var to_flight_search_muticity1 = $('#to_flight_search_muticity1').attr('data-selected');
  if (typeof to_flight_search_muticity1 !== typeof undefined && to_flight_search_muticity1 !== false) {
    $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+to_flight_search_muticity1+'"]').hide();
  } */

  removeSuggetions('from_flight_search_muticity1'); removeSuggetions('to_flight_search_muticity1');
  removeSuggetions('from_flight_search_muticity2'); removeSuggetions('to_flight_search_muticity2');
  removeSuggetions('from_flight_search_muticity3'); removeSuggetions('to_flight_search_muticity3');
  removeSuggetions('from_flight_search_muticity4'); removeSuggetions('to_flight_search_muticity4');
  removeSuggetions('from_flight_search_muticity5'); removeSuggetions('to_flight_search_muticity5');
  removeSuggetions('from_flight_search_muticity6'); removeSuggetions('to_flight_search_muticity6');
  removeSuggetions('from_flight_search_muticity7'); removeSuggetions('to_flight_search_muticity7');
  removeSuggetions('from_flight_search_muticity8'); removeSuggetions('to_flight_search_muticity8');
  removeSuggetions('from_flight_search_muticity9'); removeSuggetions('to_flight_search_muticity9');
  removeSuggetions('from_flight_search_muticity10'); removeSuggetions('to_flight_search_muticity10');

});

function removeSuggetions(elem){
  var elem = $('#'+elem).attr('data-selected');
  if (typeof elem !== typeof undefined && elem !== false) {
    $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+elem+'"]').hide();
  }
};
  function fixRangeSelection() {
  $('.month-wrapper').find('table .day.nextMonth, table .day.lastMonth').parent().addClass('invalid-date-td');
  $('.month-wrapper').find('table .first-date-selected.checked.lastMonth').parent().removeClass('first-date-selected-td');
  $('.month-wrapper').find('table .last-date-selected.checked.lastMonth').parent().removeClass('last-date-selected-td');
}

$('.datepicker-dropdown').mask("00/00/0000");

/*single-date-picker*/
if($('.single-date-picker').length){
  $('.single-date-picker').on("focus", function() {
      var currentId = $(this).attr('id');
      var contanerID = '#'+currentId+'_range_picker';
      var currentIdDom = '#'+currentId;

      //console.log(currentId, contanerID, currentIdDom);
      
      var defaultStartDate = new Date();
      
      
      if( $(this).parents().hasClass('hidden-field-group') ){
        if( $(this).parents('.form-wrap').index()!=0 ){
          var previewsDateSelected = $(this).parents('.form-wrap').prev().find('.single-date-picker').val();
          if(previewsDateSelected!=''){
            defaultStartDate = previewsDateSelected;
          }
        } else {
          var firstSelectedDate = $('.sub-panel-data#multi-city .form-wrap.active').find('.single-date-picker').val();
          if(firstSelectedDate!=''){
            defaultStartDate = firstSelectedDate;
          }
        }
      }

      console.log(defaultStartDate);
      
      $(currentIdDom).dateRangePicker({
          format: 'ddd, MMM DD YYYY',
          inline: true,
          stickyMonths: true,
          container: contanerID,
          showTopbar: false,
          singleDate: true,
          startDate: defaultStartDate,
          hoveringTooltip: false,
          //singleMonth: true,
          alwaysOpen: true,
          customArrowPrevSymbol: '<i class="icon icon-arrow-down"></i>',
          customArrowNextSymbol: '<i class="icon icon-arrow-up"></i>'
      }).bind('datepicker-change', function(evt, obj) {

          $('#'+currentId).val(obj.value);
          $(currentIdDom).parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
          $(currentIdDom).parents('.daterangepicker-single').find('.float-label-wrapper').addClass('populated');
          $(currentIdDom).parents('.daterangepicker-single').removeClass('show-popup');
          var nextTabIndex = evt.currentTarget.tabIndex + 1;
          $(this).parents('.sub-panel-data').find('input[tabindex="' + nextTabIndex + '"]').focus();
          if ($(this).parents('.sub-panel-data').find('input[tabindex="' + nextTabIndex + '"]').hasClass('dropdown-toggle')) {
              $(this).parents('.sub-panel-data').find('input[tabindex="' + nextTabIndex + '"]').next('.dropdown-menu').toggleClass('show');
          }

          $(this).parents('.form-wrap').nextAll().find('.single-date-picker').val('');
          $(this).parents('.form-wrap').nextAll().find('.daterangepicker-single').find('.float-label-wrapper').removeClass('populated');
          
          checkValid();
          
      }).click(function(evt) {
        
        // $(currentIdDom).data('dateRangePicker').setStart( moment(defaultStartDate).format("ddd, MMM DD YYYY") );

        $('.dropdown-toggle + .dropdown-menu').removeClass('show');
        $(currentIdDom).parents('.daterangepicker-single').find('.range-picker-wrap').addClass('active');
        $(currentIdDom).parents('.daterangepicker-single').addClass('show-popup');

        evt.stopPropagation();

      });

      $(currentIdDom).data('dateRangePicker').setStart( moment(defaultStartDate).format("ddd, MMM DD YYYY") );

  });
}
/*single-date-picker*/


/*departure flight date picker*/
if($('#departure_flight_search').length){
  $('#departure_flight_search').dateRangePicker({
    format: 'ddd, MMM DD YYYY',
    inline: true,
    stickyMonths: true,
    container: '#departure_flight_date_range', 
    showTopbar: false,
    singleDate : true,
    startDate: new Date(),
    hoveringTooltip: false,
    alwaysOpen: true,
    customArrowPrevSymbol: '<i class="icon icon-arrow-down"></i>',
    customArrowNextSymbol: '<i class="icon icon-arrow-up"></i>' 
  }).bind('datepicker-change', function(evt, obj) {
    $('#departure_flight_search').val(obj.value);
    $('#departure_flight_search').parent('.form-field').addClass('populated');

    // $(this).parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    // $('#return_flight_search').parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');

    $('#return_flight_search').data('dateRangePicker').setStart(obj.value);
    //$('#return_flight_search').parents('.group-field-wrap').find('.float-label-wrapper').addClass('populated');

    var new_date = moment(new Date(obj.value), "ddd, MMM DD YYYY").add(7, 'days');
    var udpatedDate = moment(new_date._d).format("ddd, MMM DD YYYY");

    $('#return_flight_search').parents('.group-field-wrap').find('.float-label-wrapper').removeClass('populated');
    
    // if($('#return_flight_search').val() == ''){
    $('#return_flight_search').val(udpatedDate);
    $('#return_flight_search').data('dateRangePicker').setEnd(udpatedDate);
    // }

    $('#departure_flight_search').trigger('change');

    fixRangeSelection();
    checkFlightLocationInputStatus();

  }).bind('datepicker-first-date-selected', function(evt, obj) { 
    
    fixRangeSelection();

  }).click(function(evt){
    evt.stopPropagation();
    $('.dropdown-toggle + .dropdown-menu').removeClass('show');
    
    if(viewportWidth > 991){
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    } else {
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').addClass('active');
    }

    $('#return_flight_search').parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');

    $(this).parents('.daterangepicker-group').addClass('show-popup');

    checkFlightLocationInputStatus();

  });
}
/*departure flight date picker*/


/*return flight date picker*/
//var departure_formated_date = moment(new Date($('#departure_flight_search').val())).format("YYYY-MM-DD");
if($('#return_flight_search').length){
  $('#return_flight_search').dateRangePicker({
    format: 'ddd, MMM DD YYYY',
    inline: true,
    stickyMonths: true,
    container: '#return_flight_date_range', 
    showTopbar: false,
    hoveringTooltip: false,
    alwaysOpen: true,
    startDate: new Date(),
    selectForward: true,
    customArrowPrevSymbol: '<i class="icon icon-arrow-down"></i>',
    customArrowNextSymbol: '<i class="icon icon-arrow-up"></i>'
  }).bind('datepicker-change', function(evt, obj) {  
    
    $('#departure_flight_search').data('dateRangePicker').setDateRange(obj.date1,obj.date2, true);

    $(this).parents('.group-field-wrap').find('.float-label-wrapper').addClass('populated');

    //Departure and Return date updating on check-in and out fields.
    var departure_formated_date = moment(new Date(obj.date1)).format("ddd, MMM DD YYYY");
    var return_formated_date = moment(new Date(obj.date2)).format("ddd, MMM DD YYYY");
    $('#checkin_hotel_search').val(departure_formated_date);
    $('#checkout_hotel_search').val(return_formated_date);

    //Updating the new dates on fields.
    $('#departure_flight_search').val(departure_formated_date);
    $('#return_flight_search').val(return_formated_date);

    //Changing focus to next field.
    //$('#passengers_flight_search').focus();
    //$('#passengers_flight_search').next('.dropdown-menu').toggleClass('show');

    //Triggering changes on fields and hiding popup.
    //$('#return_flight_search').trigger('change');
    //$(this).parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
    //$(this).parents('.daterangepicker-group').removeClass('show-popup');

    fixRangeSelection();
    checkFlightLocationInputStatus();

    //Triggering changes on fields and hiding popup.
    $('#return_flight_search').trigger('change');
    $('#return_flight_search').parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
    $('#return_flight_search').parents('.daterangepicker-group').removeClass('show-popup');

    //Changing focus to next field.
    if($('#departure_flight_search').parents('.group-field-wrap').find('.range-picker-wrap').hasClass('active') == false){
      $('#passengers_flight_search').focus();
      $('#passengers_flight_search').next('.dropdown-menu').toggleClass('show');
    }

    $('#return_flight_search').data('dateRangePicker').close();

  }).bind('datepicker-first-date-selected', function(evt, obj) { 
    
    fixRangeSelection();

  }).bind('datepicker-closed', function(evt, obj) {  
    

  }).click(function(evt){
    evt.stopPropagation();
    
    $('.dropdown-toggle + .dropdown-menu').removeClass('show');
    $('#departure_flight_search').parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
    
    if(viewportWidth > 991){
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    } else {
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').addClass('active');
    }
    
    var departure_formated_date = moment(new Date($('#departure_flight_search').val())).format("ddd, MMM DD YYYY");
    var return_flight_search = moment(new Date($('#return_flight_search').val())).format("ddd, MMM DD YYYY");
    if(departure_formated_date != 'Invalid date'){
      $('#return_flight_search').data('dateRangePicker').setStart(departure_formated_date);
    }

    // $('#return_flight_search').data('dateRangePicker').setEnd(return_flight_search);

    $(this).parents('.daterangepicker-group').addClass('show-popup');

    fixRangeSelection();
    checkFlightLocationInputStatus();

  });
}
/*return flight date picker*/


/*check-in hotel date picker*/
if($('#checkin_hotel_search').length){
  $('#checkin_hotel_search').dateRangePicker({
    format: 'ddd, MMM DD YYYY',
    inline: true,
    stickyMonths: true,
    container: '#checkin_hotel_search_date_range', 
    showTopbar: false,
    singleDate : true,
    startDate: new Date(),
    hoveringTooltip: false,
    alwaysOpen: true,
    customArrowPrevSymbol: '<i class="icon icon-arrow-down"></i>',
    customArrowNextSymbol: '<i class="icon icon-arrow-up"></i>' 
  }).bind('datepicker-change', function(evt, obj) {
    console.log(obj.value);
    $('#checkin_hotel_search').val(obj.value);
    $('#checkin_hotel_search').parent('.form-field').addClass('populated');
    $(this).parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    $('#checkout_hotel_search').parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    $('#checkout_hotel_search').data('dateRangePicker').setStart(obj.value);
    $('#checkout_hotel_search').parents('.group-field-wrap').find('.float-label-wrapper').addClass('populated');
    $('#checkin_hotel_search').trigger('blur');
    fixRangeSelection();
  }).click(function(evt){
    evt.stopPropagation();
    console.log('clicked');
    $('.dropdown-toggle + .dropdown-menu').removeClass('show');
    if(viewportWidth > 991){
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    } else {
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').addClass('active');
    }
    $('#checkout_hotel_search').parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
    $(this).parents('.daterangepicker-group').addClass('show-popup');
  });
}
/*check-in hotel date picker*/


/*check-out hotel date picker*/
if($('#checkout_hotel_search').length){
  $('#checkout_hotel_search').dateRangePicker({
    format: 'ddd, MMM DD YYYY',
    inline: true,
    stickyMonths: true,
    container: '#checkout_hotel_search_date_range', 
    showTopbar: false,
    hoveringTooltip: false,
    alwaysOpen: true,
    //startDate: departure_formated_date,
    selectForward: true,
    customArrowPrevSymbol: '<i class="icon icon-arrow-down"></i>',
    customArrowNextSymbol: '<i class="icon icon-arrow-up"></i>'
  }).bind('datepicker-change', function(evt, obj) {  
    $(this).parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
    $('#checkin_hotel_search').data('dateRangePicker').setDateRange(obj.date1,obj.date2, true);
    var departure_formated_date = moment(new Date(obj.date1)).format("ddd, MMM DD YYYY");
    var return_formated_date = moment(new Date(obj.date2)).format("ddd, MMM DD YYYY");
    $('#checkout_hotel_search').val(departure_formated_date);
    $('#checkout_hotel_search').val(return_formated_date);
    $('#checkout_hotel_search').trigger('blur');
    $(this).parents('.daterangepicker-group').removeClass('show-popup');
    fixRangeSelection();
  }).click(function(evt){
    evt.stopPropagation();
    $('.dropdown-toggle + .dropdown-menu').removeClass('show');
    $('#checkout_hotel_search').parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
    if(viewportWidth > 991){
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').toggleClass('active');
    } else {
      $(this).parents('.group-field-wrap').find('.range-picker-wrap').addClass('active');
    }
    var departure_formated_date = moment(new Date($('#checkin_hotel_search').val())).format("ddd, MMM DD YYYY");
    if(departure_formated_date != 'Invalid date'){
      $('#checkout_hotel_search').data('dateRangePicker').setStart(departure_formated_date);
    }
    $('#checkin_hotel_search').parents('.group-field-wrap').find('.range-picker-wrap').removeClass('active');
    $(this).parents('.daterangepicker-group').addClass('show-popup');
  });
}
/*check-out hotel date picker*/

/* daterangepicker selection fixes*/
$('.date-picker-wrapper').on('click', 'table .caption', function() {
  fixRangeSelection();
});

if(viewportWidth < 992){
  $('.range-picker-wrap .date-picker-wrapper').css('max-height', windowHeight - 150);
};
  $('.panel-table-wrap input[type=radio]').change(function() {
	var samecheckststus = $(this).parents('.panel-table-wrap').find('.checkbox-wrap input').is(':checked');
	if(samecheckststus){
	
		var currentIndex = $(this).parents('td').index();
		// $(this).parents('.panel-table-row').siblings().find('input[type=radio]').prop('checked', false);
		// $(this).parents('.panel-table-row').find('input[type=radio]').prop('checked', true);

		$(this).parents('.panel-table-row').siblings().find('td').find('input[type=radio]').prop('checked', false);
		$(this).parents('.panel-table-row').siblings().each(function(){
			$(this).find('td').eq(currentIndex).find('input[type=radio]').prop('checked', true);
		});

	}
});

$('.panel-table-wrap input[type=checkbox]').change(function() {
	var samecheckststus = $(this).parents('.panel-table-wrap').find('.checkbox-wrap input').is(':checked');
	if(samecheckststus){
		var selectIndex = 3;
		
		$(this).parents('thead').next('tbody').find('.panel-table-row').each(function(){
			var checkSlect = $(this).find('input[type=radio]:checked').parents('td').index();
			if(checkSlect != 3){
				selectIndex = checkSlect;
			}
		});
		
		$(this).parents('thead').next('tbody').find('.panel-table-row td').find('input[type=radio]').prop('checked', false);
		$(this).parents('thead').next('tbody').find('.panel-table-row').each(function(){
			$(this).find('td').eq(selectIndex).find('input[type=radio]').prop('checked', true);
		});
	}
});

//Mobile cloning


$('.add-ons-baggage-wrap .accordion-item').each(function(){
	var blockLabel = $(this).find('.panel-table-wrap .panel-table thead .panel-table-row td:nth-child(2) .panel-table-data').text();
	$(this).find('.panel-table-wrap .panel-table tbody .panel-table-row').each(function(){
		$(this).find('td:first').append('<div class="table-data-label">'+blockLabel+'</div>');
	});
});;
  /*language switcher*/
var country = '';
var airportList = [];
$.getJSON("assets/json/countries.json", function(data){
  for (var i = 0, len = data.length; i < len; i++) {
      var country = '<div class="dropdown-option"><div class="country"><div class="flag"><i class="flag-icon flag-icon-'+data[i].alpha2+'"></i></div><div class="country-label">'+data[i].name+'</div></div><div class="languages"><a href="#" data-code="'+data[i].alpha3+'" data-lang="en">English</a><a href="#" data-code="'+data[i].alpha3+'" data-lang="ar">عربي</a></div></div>';
      airportList.push(country);
  }
  $('#language-switcher').append(airportList);
});

$('body').on('click','.dropdown-option .languages a',function(e){
  var selCode = $(this).attr('data-code');
  var selLang = $(this).attr('data-lang');
  $('.btn-dropdown .country-code').empty().append(selCode);
  $('.btn-dropdown .language-code').empty().append(selLang);
  $('.toggle-btns li .btn-dropdown-menu').removeClass('show');
  isheaderActive();
  e.preventDefault();
});
/*language switcher*/;

  $('.btn-dropdown').click(function(){
  $(this).parents('li').siblings().find('.btn-dropdown').removeClass('active');
  $(this).toggleClass('active');
  $(this).parents('li').siblings().find('.btn-dropdown-menu').removeClass('show');
  $(this).next('.btn-dropdown-menu').toggleClass('show');
  $('header .header-inner .main-nav > li').removeClass('active');
  isheaderActive();
});

$('#closeSearch').click(function(){
  $('.search-box-wrap').removeClass('active');
  issearchActive();
});

$('#showSearchPanel').click(function(){
  $('.btn.btn-dropdown').removeClass('active');
  $('.search-box-wrap').addClass('active');
  issearchActive();
});


$('#closeModifySearch').click(function(){
  $('.modify-search-wrap').removeClass('active');
  isModifySearchActive();
});

$('#showModifySearchPanel').click(function(e){
  $('.btn.btn-dropdown').removeClass('active');
  $('.modify-search-wrap').addClass('active');
  isModifySearchActive();
  e.preventDefault();
});

//$('.btn-dropdown-menu').click(function(e){
$(".btn-dropdown-menu").on('click', function () {
  if($(this).hasClass('show')){
    $('.jazeera_overlay').addClass('active');
    bodyFreezeScroll();
  } else {
    $('.jazeera_overlay').removeClass('active');
    bodyUnfreezeScroll();
  }
});

$(".search-panel").on('click', function () {
  if($(this).parent().hasClass('active')){
    bodyFreezeScroll();
  } else {
    bodyUnfreezeScroll();
  }
});

$(".main-nav > li .sub-menu").on('click', function () {
  if($(this).parent().hasClass('active')){
    $('.jazeera_overlay').addClass('active');
    bodyFreezeScroll();
  } else {
    $('.jazeera_overlay').removeClass('active');
    bodyUnfreezeScroll();
  }
});

$('.dropdown-wrap').click(function(e){
  //$(this).toggleClass('active');
  $(this).toggleClass('show');
  e.preventDefault();
});

$('.dropdown-toggle').click(function(){
  var dropmenu = $(this).attr('data-toggle');
  $(this).next('.'+dropmenu).toggleClass('show');
});
$('.dropdown-arrow').click(function(){
  $(this).prev('.dropdown-menu').toggleClass('show');
});


$('.dropdown-menu .dropdown-option').click(function(){
  $(this).parents('.dropdown-wrap').find('.dropdown').empty().append( $(this).find('h5').html() );
});


$('.custom-select').each(function(e){
  if( $(this).val() == '' ){
    $(this).parents('.form-field').removeClass('populated');
  } else {
    $(this).parents('.form-field').addClass('populated');
  }
});

$('.custom-select').change(function(e){
  if( $(this).val() == '' ){
    $(this).parents('.form-field').removeClass('populated');
  } else {
    $(this).parents('.form-field').addClass('populated');
  }
});

if(viewportWidth < 767){
  $('.footer-navigation .col-md-3:last-child .footer-menu').addClass('active default-active');
  $('.footer-menu li a strong').click(function(e){
    if( !$(this).parents('.footer-menu').hasClass('default-active') ){
      $(this).parents('.col-md-3').siblings().find('.footer-menu').removeClass('active');
      $('.footer-navigation .col-md-3:last-child .footer-menu').addClass('active default-active');
      $(this).parents('.footer-menu').toggleClass('active');
      e.preventDefault();
    }
  });

  $('.footer-navigation .col-md-3:last-child .footer-menu').click(function(e){
    return false;
    e.preventDefault();
  });
}
;
  $('[data-toggle="tooltip"]').tooltip({
	template: '<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>'
}); 

$('[data-tooltip="tooltip"]').tooltip({
	template: '<div class="tooltip-flight-seat" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>'
}); ;
  $('.flight-info-wrap.departure .packages-footer a.btn').click(function(e){
  $('.flight-info-wrap.departure').addClass('hide');

  if( $('.flight-summary-main-wrap.return').hasClass('show') ){
    $('.flight-summary-main-wrap.departure').removeClass('show');
  } else {
    $('.flight-summary-main-wrap.departure').addClass('show');
	}

  $('body').scrollTo('section.flight-summary-main-wrap.departure', 0);
	
	setTimeout(function(){
		$('.flight-summary-main-wrap.departure a[data-goto-href]').trigger('click');
	}, 2000);

  e.preventDefault();
});

$('.flight-info-wrap.return .packages-footer a.btn').click(function(e){
  $('.flight-info-wrap.departure').addClass('hide');
  $('.flight-summary-main-wrap.departure').removeClass('show');
  $('.flight-info-wrap.return').addClass('hide');
  $('.flight-summary-main-wrap.return').addClass('show');
  e.preventDefault();
});

//$('.switch-flight-info-wrap .date-range-list .date-tab-wrap').click(function(){
$(document).on("click", ".switch-flight-info-wrap .date-range-list .date-tab-wrap", function() {
  $(this).siblings().removeClass('selected');
  $(this).addClass('selected');
});

$('.selected-flight-item .modify-flight a').click(function(e){
  var modify_flight = $(this).attr('href');
  if(modify_flight == '#departing_flight'){
    $('.flight-info-wrap.departure').removeClass('hide');
    $('.flight-summary-main-wrap.departure').removeClass('show');
  }
  if(modify_flight == '#return_flight'){
    $('.flight-info-wrap.return').removeClass('hide');
    $('.flight-summary-main-wrap.return').removeClass('show');
  }
  e.preventDefault();
});

$('.flight-search-result-item .view-detail-btn').click(function(e){
  $(this).parents('.flight-search-result-item').siblings().find('.flight-info-container .expanded').removeClass('active');
  $(this).parents('.flight-search-result-item').siblings().find('.flight-info-container .collapsed').addClass('active');
  $(this).parents('.flight-search-result-item').find('.flight-info-container .collapsed').toggleClass('active')
  $(this).parents('.flight-search-result-item').find('.flight-info-container .expanded').toggleClass('active')
  e.preventDefault();
});

/*
$('.form-field .icon').click(function(){
  $(this).parents('.form-field').find('input').trigger('click');
});
*/


$('.flight-class-item .expand-arrow').click(function(e){

  $(this).parents('.flight-search-result-item').siblings().find('.expand-arrow').removeClass('active');
  $(this).parents('.flight-search-result-item').siblings().find('.flight-class-additional-wrap').removeClass('active');

  var currentExp = $(this).attr('data-class');
  if(currentExp == 'economy-class'){
    $(this).toggleClass('active');
    $(this).parents('.flight-search-result-item').find('.expand-arrow[data-class="business-class"]').removeClass('active');
    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.economy-class').toggleClass('active');
    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.business-class').removeClass('active');
  }

  if(currentExp == 'business-class'){
    $(this).toggleClass('active');
    $(this).parents('.flight-search-result-item').find('.expand-arrow[data-class="economy-class"]').removeClass('active');
    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.business-class').toggleClass('active');
    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.economy-class').removeClass('active');
  }

  e.preventDefault();
});


//Mobile
$('.flight-class-item').click(function(e){
	if(viewportWidth < 992){
	  $(this).parents('.flight-search-result-item').siblings().removeClass('show-popup');
	  $(this).parents('.flight-search-result-item').siblings().find('.flight-class-item').removeClass('active');
	  $(this).parents('.flight-search-result-item').siblings().find('.flight-class-additional-wrap').removeClass('active');
	  bodyFreezeScroll();
	  var currentExp = $(this).find('.expand-arrow').attr('data-class');
	  if(currentExp == 'economy-class'){
	    $(this).addClass('active');
	    $(this).parents('.flight-search-result-item').siblings().removeClass('show-popup');
	    $(this).parents('.flight-search-result-item').addClass('show-popup');
	    $(this).parents('.flight-search-result-item').find('.expand-arrow[data-class="business-class"]').parent('.flight-class-item').removeClass('active');
	    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.economy-class').addClass('active');
	    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.business-class').removeClass('active');
	  }

	  if(currentExp == 'business-class'){
	    $(this).addClass('active');
	    $(this).parents('.flight-search-result-item').siblings().removeClass('show-popup');
	    $(this).parents('.flight-search-result-item').addClass('show-popup');
	    $(this).parents('.flight-search-result-item').find('.expand-arrow[data-class="economy-class"]').parent('.flight-class-item').removeClass('active');
	    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.business-class').addClass('active');
	    $(this).parents('.flight-search-result-item').find('.flight-class-additional-wrap.economy-class').removeClass('active');
	  }

	}
e.preventDefault();
});

if( $('.expand-arrow.active').length==1 ){
	if(viewportWidth < 992){
		$('.expand-arrow.active').parents('.flight-class-item').trigger('click');
	}
}

/*Dates tabs*/
var flightDates = [
	{
		'recommend': false,
		'cost': '<div class="cost-info"> <div class="cost-label">From</div> <div class="cost"> INR <strong>5,898.00 </div></div>',
	},
	{
		'recommend': false,
		'cost': '<div class="cost-info"> <div class="cost-label">From</div> <div class="cost"> INR <strong>5,238.00 </div></div>',
	},
	{
		'recommend': false,
		'cost': '<div class="cost-info"> <div class="cost-label">From</div> <div class="cost"> INR <strong>5,768.00 </div></div>',
	},
	{
		'recommend': false,
		'cost': '<div class="cost-info"> <div class="cost-label">From</div> <div class="cost"> INR <strong>5,498.00 </div></div>',
	},
	{
		'recommend': true,
		'cost': '<div class="cost-info"> <div class="cost-label">From</div> <div class="cost"> INR <strong>3,898.00 </div></div>',
	},
	{
		'recommend': false,
		'cost': '<div class="cost-info"> <div class="cost-label">From</div> <div class="cost"> INR <strong>7,898.00 </div></div>',
	},
	{
		'recommend': false,
		'cost': '',
	}
];

var dataDates = [];
var datesArr = [];

function prepareDate(lastWeek, nextWeek, load, isDesktop){

	if(isDesktop){

		var out = '';
		for(var i = 1; i < 8; i++){

			var item = flightDates[Math.floor(Math.random()*flightDates.length)];

			out = '';
			if(item.recommend){
				out += '<div class="hightlight bg-success">Lowest Fair</div>';
			}

			out+= '<div class="date"><strong>'+moment(datesArr[i-1], 'DD-MM-YYYY').format("DD MMM")+',</strong> '+moment(datesArr[i-1], 'DD-MM-YYYY').format("ddd")+'</div>';;

			if(item.cost!=''){
				out+= item.cost;
			} else {
				out+= '<div class="msg">No Flights <br>Available</div>';
			}

			if(load=='initLoad'){
				if(i==4){
					dataDates.push('<div class="date-tab-wrap selected"> '+ out +' </div>');
				} else {
					if(item.cost!=''){
						dataDates.push('<div class="date-tab-wrap"> '+ out +' </div>');
					} else {
						dataDates.push('<div class="date-tab-wrap inactive"> '+ out +' </div>');
					}
				}
			} else {

				if(i==1){
					dataDates.push('<div class="date-tab-wrap selected"> '+ out +' </div>');
				} else {
					if(item.cost!=''){
						dataDates.push('<div class="date-tab-wrap"> '+ out +' </div>');
					} else {
						dataDates.push('<div class="date-tab-wrap inactive"> '+ out +' </div>');
					}
				}

			}

		}

		$('.dynamic-dates').empty().append(dataDates);

		$('.flight-info-wrap.action .select-date-range.prev-date-range').empty().html('<div class="hidden-date">'+moment(lastWeek, 'DD-MM-YYYY').subtract(1, 'days').format('DD-MM-YYYY')+'</div> '+'<strong>'+moment(lastWeek, 'DD-MM-YYYY').subtract(7, 'days').format('DD MMM')+'</strong> to <strong>'+moment(lastWeek, 'DD-MM-YYYY').subtract(1, 'days').format('DD MMM')+'</strong>');
		$('.flight-info-wrap.action .select-date-range.next-date-range').empty().html('<div class="hidden-date">'+moment(nextWeek, 'DD-MM-YYYY').add(1, 'days').format('DD-MM-YYYY')+'</div> '+'<strong>'+moment(nextWeek, 'DD-MM-YYYY').add(1, 'days').format('DD MMM')+'</strong> to <strong>'+moment(nextWeek, 'DD-MM-YYYY').add(7, 'days').format('DD MMM')+'</strong>');

	} else {

		var out = '';
		for(var i = 1; i < 4; i++){

			var item = flightDates[Math.floor(Math.random()*flightDates.length)];

			out = '';
			if(item.recommend){
				out += '<div class="hightlight bg-success">Lowest Fair</div>';
			}

			out+= '<div class="date"><strong>'+moment(datesArr[i-1], 'DD-MM-YYYY').format("DD MMM")+',</strong> '+moment(datesArr[i-1], 'DD-MM-YYYY').format("ddd")+'</div>';;

			if(item.cost!=''){
				out+= item.cost;
			} else {
				out+= '<div class="msg">No Flights <br>Available</div>';
			}

			if(load=='initLoad'){
				if(i==2){
					dataDates.push('<div class="date-tab-wrap selected"> '+ out +' </div>');
				} else {
					if(item.cost!=''){
						dataDates.push('<div class="date-tab-wrap"> '+ out +' </div>');
					} else {
						dataDates.push('<div class="date-tab-wrap inactive"> '+ out +' </div>');
					}
				}
			} else {

				if(i==1){
					dataDates.push('<div class="date-tab-wrap selected"> '+ out +' </div>');
				} else {
					if(item.cost!=''){
						dataDates.push('<div class="date-tab-wrap"> '+ out +' </div>');
					} else {
						dataDates.push('<div class="date-tab-wrap inactive"> '+ out +' </div>');
					}
				}

			}

		}

		$('.dynamic-dates').empty().append(dataDates);

		$('.flight-info-wrap.action .select-date-range.prev-date-range').empty().html('<div class="hidden-date">'+lastWeek+'</div>');
		$('.flight-info-wrap.action .select-date-range.next-date-range').empty().html('<div class="hidden-date">'+nextWeek+'</div>');

	}


}

function getWeekDates(startDate, weekOf, isDesktop) {


	if(isDesktop){

		if(startDate == moment().format('DD-MM-YYYY')){

			datesArr = [];
			dataDates = [];

			datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(3, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(2, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(1, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').add(0, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').add(1, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').add(2, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').add(3, 'days').format('DD-MM-YYYY') );

			prepareDate( moment(startDate, 'DD-MM-YYYY').subtract(3, 'days').format('DD-MM-YYYY'),  moment(startDate, 'DD-MM-YYYY').add(3, 'days').format('DD-MM-YYYY'), 'initLoad', true);

		} else {

			if(weekOf == 'getNextWeek'){

				datesArr = [];
				dataDates = [];

				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(0, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(1, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(2, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(3, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(4, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(5, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(6, 'days').format('DD-MM-YYYY') );

				prepareDate(moment(startDate, 'DD-MM-YYYY').add(0, 'days').format('DD-MM-YYYY'), moment(startDate, 'DD-MM-YYYY').add(6, 'days').format('DD-MM-YYYY'), 'nextLoad', true);

			}

			if(weekOf == 'getLastWeek'){

				datesArr = [];
				dataDates = [];

				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(6, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(5, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(4, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(3, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(2, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(1, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(0, 'days').format('DD-MM-YYYY') );

				prepareDate(moment(startDate, 'DD-MM-YYYY').subtract(6, 'days').format('DD-MM-YYYY'), moment(startDate, 'DD-MM-YYYY').subtract(0, 'days').format('DD-MM-YYYY'), 'prevLoad', true);

			}

		}

	} else {

		if(startDate == moment().format('DD-MM-YYYY')){

			datesArr = [];
			dataDates = [];

			datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(1, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').add(0, 'days').format('DD-MM-YYYY') );
			datesArr.push( moment(startDate, 'DD-MM-YYYY').add(1, 'days').format('DD-MM-YYYY') );

			prepareDate( moment(startDate, 'DD-MM-YYYY').subtract(3, 'days').format('DD-MM-YYYY'),  moment(startDate, 'DD-MM-YYYY').add(3, 'days').format('DD-MM-YYYY'), 'initLoad', false);

		} else {

			if(weekOf == 'getNextWeek'){

				datesArr = [];
				dataDates = [];

				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(1, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(0, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(1, 'days').format('DD-MM-YYYY') );

				prepareDate( moment(startDate, 'DD-MM-YYYY').subtract(3, 'days').format('DD-MM-YYYY'),  moment(startDate, 'DD-MM-YYYY').add(3, 'days').format('DD-MM-YYYY'), 'nextLoad', false);

			}

			if(weekOf == 'getLastWeek'){

				datesArr = [];
				dataDates = [];

				datesArr.push( moment(startDate, 'DD-MM-YYYY').subtract(1, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(0, 'days').format('DD-MM-YYYY') );
				datesArr.push( moment(startDate, 'DD-MM-YYYY').add(1, 'days').format('DD-MM-YYYY') );

				prepareDate( moment(startDate, 'DD-MM-YYYY').subtract(3, 'days').format('DD-MM-YYYY'),  moment(startDate, 'DD-MM-YYYY').add(3, 'days').format('DD-MM-YYYY'), 'prevLoad', false);

			}

		}

	}

}

if(viewportWidth > 991){
	getWeekDates(moment().format('DD-MM-YYYY'), '', true);
	$('.action .select-date-range.next-date-range').click(function(){
		var setdate = $(this).find('.hidden-date').html();
		getWeekDates(setdate, 'getNextWeek', true);
	});
	$('.action .select-date-range.prev-date-range').click(function(){
		var setdate = $(this).find('.hidden-date').html();
		getWeekDates(setdate, 'getLastWeek', true);
	});
} else {
	getWeekDates(moment().format('DD-MM-YYYY'), '', false);
	$('.action .select-date-range.next-date-range').click(function(){
		var setdate = $(this).find('.hidden-date').html();
		getWeekDates(setdate, 'getNextWeek', false);
	});
	$('.action .select-date-range.prev-date-range').click(function(){
		var setdate = $(this).find('.hidden-date').html();
		getWeekDates(setdate, 'getLastWeek', false);
	});
}
;
  //clear location select
$('.location-select').parent().append('<span class="clearInput"><i class="icon-wrong"></i></span>');

$('.clearInput').click(function(){

  var selectedCode = $(this).parents('.form-field').find('input').attr('data-selected');
  $('.tt-menu .tt-dataset').find('.tt-suggestion[data-code="'+selectedCode+'"]').show();
  $(this).parents('.form-field').find('input').removeAttr('data-selected');

  $(this).parents('.form-field').removeClass('populated');
  $(this).parents('.form-field').find('input').focus().val("").trigger("input").parents('.locations').addClass('show-popup');
  $('.switchLocations').removeClass('active');
  checkFlightLocationInputStatus();

  $('.range-picker-wrap.active').removeClass('active');
  $('.daterangepicker-single.show-popup').removeClass('show-popup');

});

$('.close-popup').click(function(){
  $(this).parents().removeClass('show-popup');
});


/*switch location button*/
$('.switchLocations').click(function(e){
  var locations = [];
  var codes = [];
  var from = $(this).parents('.form-row').find('.locations:first-child').find('.tt-input').val();
  var from_code = $(this).parents('.form-row').find('.locations:first-child').find('.tt-input').attr('data-selected');
  var to = $(this).parents('.form-row').find('.locations:last-child').find('.tt-input').val();
  var to_code = $(this).parents('.form-row').find('.locations:last-child').find('.tt-input').attr('data-selected');

  if(from!='' && to!=''){
    locations.push(from, to);
    codes.push(from_code, to_code);
  }
  if(locations.length > 1){
    $(this).prev().find('input').val(locations[1]);
    $(this).prev().find('input').attr('data-selected', codes[1]);
    $(this).next().find('input').val(locations[0]);
    $(this).next().find('input').attr('data-selected', codes[0]);
  }    
  e.preventDefault();
});
/*switch location button*/


//Close button - flight rows
$('.form-row.row + .hidden-field-group .form-row').each(function(){
  $(this).append('<div class="close-row"><i class="icon icon-wrong"></i></div>');
});


$('.form-row.row + .hidden-field-group .form-row .close-row').click(function(){

  $(this).parent('.form-row').removeClass('active');
  
  $(this).parent('.form-row').find('.single-date-picker').data('dateRangePicker').clear();
  $(this).parent('.form-row').find('.float-label-wrapper').removeClass('populated');
  $(this).parent('.form-row').nextAll().find('.float-label-wrapper').removeClass('populated');

  $(this).parent('.form-row').find('input').val('');
  $(this).parent('.form-row').nextAll().find('input').val('');
  $(this).parents('.form-row').find('.locations input').removeAttr('data-selected');
  $(this).parents('.form-row').nextAll().find('.locations input').removeAttr('data-selected');
  $(this).parents('.form-row').find('.location-select').typeahead('val','');
  $(this).parents('.form-row').nextAll().find('.location-select').typeahead('val','');

  if($('.form-row.row + .hidden-field-group .form-row:not(.active)').length >= 1){
    $('#addFlight').removeClass('disabled');
  } else {
    $('#addFlight').addClass('disabled');
  }
});;

  $("[data-trigger='spinner']")
.spinner('delay', 0) //delay in ms
.spinner('changed', function(e, newVal, oldVal) {
  var passengersList = [];
  $( $(this).parents('.dropdown-menu').find('.dropdown-option') ).each(function( i ) {
   var dataLabel = $(this).find('.spinner-wrap').attr('data-label'); 
   var dataValue = $(this).find('.spinner-wrap input').val();
   if(dataValue!=0){ 
    passengersList.push([dataValue+' '+dataLabel]);
    $(this).find('.spinner-wrap input').addClass('active');
   } else {
    $(this).find('.spinner-wrap input').removeClass('active');
   }
   $(this).parents('.form-field').find('.form-control').parent().addClass('populated');
   $(this).parents('.form-field').find('.form-control').val(passengersList.join(", "));
   $(this).parents('.form-field').find('.form-control').trigger('change');
   $(this).parents('.form-field').find('.form-control').trigger('keyup');
  });
});;
  //Toggle Promo
$('.promo-wrap .add-promo').click(function(){
  $(this).toggleClass('hide');
  $(this).next('.promo-info').addClass('show');
});

//Validate Promo
$('.promo-info input').keyup(function(){
  if($(this).val().length >= 6){
    $(this).parent().find('.validate.success').show();
    $(this).parent().find('.validate.error').hide();
  } else {
    $(this).parent().find('.validate.success').hide();
    $(this).parent().find('.validate.error').show();
  }
  if($(this).val().length == 0){
    $(this).parents('.promo-info').removeClass('show');
    $(this).parents('.promo-info').prev('.add-promo').removeClass('hide');
  }
});;
  if(viewportWidth < 992){
	$('section.meal-selection .panel-meal-selection .meal-selection-grid-wrap .scroll-panel').css('height', windowHeight);
	$('.panel-meal-selection .modify-meal, .panel-meal-selection .select-meal-btn').click(function(e){
		$(this).parents('.panel-meal-selection').find('.panel-body').addClass('show-popup');
		bodyFreezeScroll();
		e.preventDefault();
	});
};
  $('.flight-mockup-wrap input:checkbox').change(function(e){
	var selectedSeats = [];
	$(this).parents('.flight-mockup-wrap').find('input:checked').each(function(){
		var seatNumber = $(this).attr('id');
		selectedSeats.push(seatNumber)
	});
	console.log(selectedSeats)
	e.preventDefault();
});

$('.selected-seat-info-wrap .modify-seat').click(function(e){
	var modifySeat = $(this).attr('href');
	if($(modifySeat).length){
		$('section.seat-selection .panel-seat-selection .seat-selection-outer-wrap .scroll-panel').scrollTo( modifySeat, 500 , {
	     offset:-100
		});
	} else {
		console.log('Error, please match the selected seat id and modify button href link.');
	}
	e.preventDefault();
});


if(viewportWidth < 991){
	$('.selected-passengers .modify-seat, .select-seat-msg .select-seat-btn').click(function(e){
		$('.accordion-item').removeClass('show-active');
		$(this).parents('.accordion-item').addClass('show-active');
		//bodyFreezeScroll();
		e.preventDefault();
	});
  $('.form-file-label .close-popup').click(function(e){
    $('.accordion-item').removeClass('show-active');
    e.preventDefault();
  });
}
;
  /*
$('.add-ons-meet-assist-wrap .accordion-item').each(function(){
  var table  = $(this).find('.panel-table-wrap .panel-table');
  table.find('tbody .panel-table-row').each(function(){
    var rowSelector = $(this).find('td:first');
    $(this).find('td:gt(0)').each(function(){
      console.log( $(this).html() );
      if( $(this).html()!='' ){
        $(this).prepend(rowSelector.html());
      }
    });
  });
});
*/
;

});

$(document).mouseup(function(e) {
  
  var container = $(".group-field-wrap");
  if (!container.is(e.target) && container.has(e.target).length === 0) 
  {
      $('.range-picker-wrap').removeClass('active');
  }

  var dropdownMenu = $(".dropdown-wrap");
  if (!dropdownMenu.is(e.target) && dropdownMenu.has(e.target).length === 0) 
  {
      dropdownMenu.removeClass('show');
  }
  
  var container2 = $(".form-field");
  if (!container2.is(e.target) && container2.has(e.target).length === 0) 
  {
      $('.dropdown-menu').removeClass('show');
  }

  var headerMenu = $("header .header-inner .main-nav > li");
  if (!headerMenu.is(e.target) && headerMenu.has(e.target).length === 0) 
  {
      $(".sub-menu").parent().removeClass('active');
  }

  var SearchPanel = $(".search-box-wrap .search-panel");
  if (!SearchPanel.is(e.target) && SearchPanel.has(e.target).length === 0) 
  {
      $(".search-box-wrap").removeClass('active');
  }

  var ModifySearchPanel = $(".modify-search-wrap .search-panel");
  if (!ModifySearchPanel.is(e.target) && ModifySearchPanel.has(e.target).length === 0) 
  {
      $(".modify-search-wrap").removeClass('active');
  }
  
  var container3 = $("header .header-inner .toggle-btns li");
  if (!container3.is(e.target) && container3.has(e.target).length === 0) 
  {
      $(".btn-dropdown-menu").removeClass('show');
      $(".btn.btn-dropdown").removeClass('active');
      isheaderActive();
  }
  
});

// The cursor gets into the menu area
$('#menu').mouseenter(function(){
    bodyFreezeScroll();
});

// The cursor leaves the menu area
$('.mCustomScrollBox').mouseleave(function(){
    bodyUnfreezeScroll();
});;
